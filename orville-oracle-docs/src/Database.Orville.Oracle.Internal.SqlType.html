<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.Orville.Oracle.Internal.SqlType</span><span>
</span><a name="line-2"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-3"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#text"><span class="hs-identifier hs-var">text</span></a><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#integer"><span class="hs-identifier hs-var">integer</span></a><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#bigInteger"><span class="hs-identifier hs-var">bigInteger</span></a><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#double"><span class="hs-identifier hs-var">double</span></a><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#boolean"><span class="hs-identifier hs-var">boolean</span></a><span>
</span><a name="line-8"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#date"><span class="hs-identifier hs-var">date</span></a><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#timestamp"><span class="hs-identifier hs-var">timestamp</span></a><span>
</span><a name="line-10"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#localTimestamp"><span class="hs-identifier hs-var">localTimestamp</span></a><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#nullableType"><span class="hs-identifier hs-var">nullableType</span></a><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#foreignRefType"><span class="hs-identifier hs-var">foreignRefType</span></a><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#convertSqlType"><span class="hs-identifier hs-var">convertSqlType</span></a><span>
</span><a name="line-14"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#maybeConvertSqlType"><span class="hs-identifier hs-var">maybeConvertSqlType</span></a><span>
</span><a name="line-15"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#integerNumber"><span class="hs-identifier hs-var">integerNumber</span></a><span>
</span><a name="line-16"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#doubleNumber"><span class="hs-identifier hs-var">doubleNumber</span></a><span>
</span><a name="line-17"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;=&lt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">join</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString.Char8</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">B8</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Int</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text.Encoding</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Enc</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Time</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Time</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Database.HDBC</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">HDBC</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text.Read</span><span class="hs-special">(</span><span class="hs-identifier hs-var">readMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-comment">{-|
  SqlType defines the mapping of a Haskell type (`a`) to a SQL column type in the
  database. This includes both how to convert the type to and from the raw values
  read from the database as well as the schema information required to create
  and migrate columns using the type.
  -}</span><span>
</span><a name="line-34"></a><span class="hs-keyword">data</span><span> </span><a name="SqlType"><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier">SqlType</span></a></a><span> </span><a name="local-6989586621679089902"><a href="#local-6989586621679089902"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SqlType"><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier">SqlType</span></a></a><span>
</span><a name="line-35"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="sqlTypeDDL"><a href="Database.Orville.Oracle.Internal.SqlType.html#sqlTypeDDL"><span class="hs-identifier">sqlTypeDDL</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-comment">-- ^ The raw SQL DDL to use when creating/migrating columns of this type</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-comment">-- (not including any NULL or NOT NULL declarations)</span><span>
</span><a name="line-38"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="sqlTypeReferenceDDL"><a href="Database.Orville.Oracle.Internal.SqlType.html#sqlTypeReferenceDDL"><span class="hs-identifier">sqlTypeReferenceDDL</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-39"></a><span>    </span><span class="hs-comment">-- ^ The raw SQL DDL to use when creating/migrating columns with foreign</span><span>
</span><a name="line-40"></a><span>    </span><span class="hs-comment">-- keys to this type. This is used foreignRefType to build a new SqlType</span><span>
</span><a name="line-41"></a><span>    </span><span class="hs-comment">-- when making foreign key fields</span><span>
</span><a name="line-42"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="sqlTypeNullable"><a href="Database.Orville.Oracle.Internal.SqlType.html#sqlTypeNullable"><span class="hs-identifier">sqlTypeNullable</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-43"></a><span>    </span><span class="hs-comment">-- ^ Indicates whether columns should be marked NULL or NOT NULL in the</span><span>
</span><a name="line-44"></a><span>    </span><span class="hs-comment">-- database schema. If this is 'True', then 'sqlTypeFromSql' should</span><span>
</span><a name="line-45"></a><span>    </span><span class="hs-comment">-- provide a handling of 'SqlNull' that returns an 'a', not 'Nothing'.</span><span>
</span><a name="line-46"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="sqlTypeId"><a href="Database.Orville.Oracle.Internal.SqlType.html#sqlTypeId"><span class="hs-identifier">sqlTypeId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlTypeId</span><span>
</span><a name="line-47"></a><span>    </span><span class="hs-comment">-- ^ 'sqlTypeId' will be compared to the 'colType' field found in the</span><span>
</span><a name="line-48"></a><span>    </span><span class="hs-comment">-- 'HDBC.SqlColDesc' return by 'describeTable' when determining whether</span><span>
</span><a name="line-49"></a><span>    </span><span class="hs-comment">-- a column type change is required when migrating the database.</span><span>
</span><a name="line-50"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="sqlTypeSqlSize"><a href="Database.Orville.Oracle.Internal.SqlType.html#sqlTypeSqlSize"><span class="hs-identifier">sqlTypeSqlSize</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-comment">-- ^ 'sqlTypeSqlSize will be compared to the 'colSize' field found in the</span><span>
</span><a name="line-52"></a><span>    </span><span class="hs-comment">-- 'HDBC.SqlColDesc' return by 'describeTable' when determining whether</span><span>
</span><a name="line-53"></a><span>    </span><span class="hs-comment">-- a column type change is required when migrating the database.</span><span>
</span><a name="line-54"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="sqlTypeToSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#sqlTypeToSql"><span class="hs-identifier">sqlTypeToSql</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679089902"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span>
</span><a name="line-55"></a><span>    </span><span class="hs-comment">-- ^ A function for converting Haskell values of this type into values to</span><span>
</span><a name="line-56"></a><span>    </span><span class="hs-comment">-- be stored in the database.</span><span>
</span><a name="line-57"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="sqlTypeFromSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#sqlTypeFromSql"><span class="hs-identifier">sqlTypeFromSql</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679089902"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-58"></a><span>    </span><span class="hs-comment">-- ^ A function for converting values of this are stored in the database</span><span>
</span><a name="line-59"></a><span>    </span><span class="hs-comment">-- into Haskell values. This function should return 'Nothing' to indicate</span><span>
</span><a name="line-60"></a><span>    </span><span class="hs-comment">-- an error if the conversion is impossible. Otherwise it should return</span><span>
</span><a name="line-61"></a><span>    </span><span class="hs-comment">-- 'Just' the corresponding 'a' value.</span><span>
</span><a name="line-62"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">{-|
  'text' defines a fixed length text field type. This corresponds to a
  &quot;CHAR(len)&quot; type in SQL.
  -}</span><span>
</span><a name="line-68"></a><span class="hs-identifier">text</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><span class="hs-identifier hs-type">T.Text</span><span>
</span><a name="line-69"></a><a name="text"><a href="Database.Orville.Oracle.Internal.SqlType.html#text"><span class="hs-identifier">text</span></a></a><span> </span><a name="local-6989586621679089998"><a href="#local-6989586621679089998"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-70"></a><span>  </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-var">SqlType</span></a><span>
</span><a name="line-71"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sqlTypeDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;CHAR(&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679089998"><span class="hs-identifier hs-var">len</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-72"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeReferenceDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeNullable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-74"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeId</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlCharT</span><span>
</span><a name="line-75"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeSqlSize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679089998"><span class="hs-identifier hs-var">len</span></a><span>
</span><a name="line-76"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeToSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#textToSql"><span class="hs-identifier hs-var">textToSql</span></a><span>
</span><a name="line-77"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeFromSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#textFromSql"><span class="hs-identifier hs-var">textFromSql</span></a><span>
</span><a name="line-78"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">{-|
  'integer' defines a 32-bit integer type. This corresponds to the &quot;INTEGER&quot; type in SQL.
  -}</span><span>
</span><a name="line-83"></a><span class="hs-identifier">integer</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><span class="hs-identifier hs-type">Int.Int32</span><span>
</span><a name="line-84"></a><a name="integer"><a href="Database.Orville.Oracle.Internal.SqlType.html#integer"><span class="hs-identifier">integer</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-85"></a><span>  </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-var">SqlType</span></a><span>
</span><a name="line-86"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sqlTypeDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;INTEGER&quot;</span><span>
</span><a name="line-87"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeReferenceDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeNullable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeId</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlBigIntT</span><span>
</span><a name="line-90"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeSqlSize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-91"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeToSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#int32ToSql"><span class="hs-identifier hs-var">int32ToSql</span></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeFromSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#int32FromSql"><span class="hs-identifier hs-var">int32FromSql</span></a><span>
</span><a name="line-93"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">{-|
  'bigInteger' defines a 64-bit integer type. This corresponds to the &quot;BIGINT&quot;
  type in SQL.
  -}</span><span>
</span><a name="line-99"></a><span class="hs-identifier">bigInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><span class="hs-identifier hs-type">Int.Int64</span><span>
</span><a name="line-100"></a><a name="bigInteger"><a href="Database.Orville.Oracle.Internal.SqlType.html#bigInteger"><span class="hs-identifier">bigInteger</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-101"></a><span>  </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-var">SqlType</span></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sqlTypeDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;BIGINT&quot;</span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeReferenceDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-104"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeNullable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeId</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlBigIntT</span><span>
</span><a name="line-106"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeSqlSize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-107"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeToSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#int64ToSql"><span class="hs-identifier hs-var">int64ToSql</span></a><span>
</span><a name="line-108"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeFromSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#int64FromSql"><span class="hs-identifier hs-var">int64FromSql</span></a><span>
</span><a name="line-109"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-comment">{-|
  'double' defines a floating point numeric type. This corresponds to the &quot;DOUBLE
  PRECISION&quot; type in SQL.
  -}</span><span>
</span><a name="line-115"></a><span class="hs-identifier">double</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-116"></a><a name="double"><a href="Database.Orville.Oracle.Internal.SqlType.html#double"><span class="hs-identifier">double</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-117"></a><span>  </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-var">SqlType</span></a><span>
</span><a name="line-118"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sqlTypeDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;DOUBLE PRECISION&quot;</span><span>
</span><a name="line-119"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeReferenceDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-120"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeNullable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-121"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeId</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlFloatT</span><span>
</span><a name="line-122"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeSqlSize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-123"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeToSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#doubleToSql"><span class="hs-identifier hs-var">doubleToSql</span></a><span>
</span><a name="line-124"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeFromSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#doubleFromSql"><span class="hs-identifier hs-var">doubleFromSql</span></a><span>
</span><a name="line-125"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-comment">{-|
  'boolean' defines a True/False boolean type. This corresponds to the &quot;BOOLEAN&quot;
  type in SQL.
  -}</span><span>
</span><a name="line-131"></a><span class="hs-identifier">boolean</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-132"></a><a name="boolean"><a href="Database.Orville.Oracle.Internal.SqlType.html#boolean"><span class="hs-identifier">boolean</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-133"></a><span>  </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-var">SqlType</span></a><span>
</span><a name="line-134"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sqlTypeDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;BOOLEAN&quot;</span><span>
</span><a name="line-135"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeReferenceDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-136"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeNullable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-137"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeId</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlBitT</span><span>
</span><a name="line-138"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeSqlSize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeToSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#booleanToSql"><span class="hs-identifier hs-var">booleanToSql</span></a><span>
</span><a name="line-140"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeFromSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#booleanFromSql"><span class="hs-identifier hs-var">booleanFromSql</span></a><span>
</span><a name="line-141"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-comment">{-|
  'date' defines a type representing a calendar date (without time zone). It corresponds
  to the &quot;DATE&quot; type in SQL.
  -}</span><span>
</span><a name="line-147"></a><span class="hs-identifier">date</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><span class="hs-identifier hs-type">Time.Day</span><span>
</span><a name="line-148"></a><a name="date"><a href="Database.Orville.Oracle.Internal.SqlType.html#date"><span class="hs-identifier">date</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-149"></a><span>  </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-var">SqlType</span></a><span>
</span><a name="line-150"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sqlTypeDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;DATE&quot;</span><span>
</span><a name="line-151"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeReferenceDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-152"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeNullable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeId</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlDateT</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeSqlSize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeToSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#dayToSql"><span class="hs-identifier hs-var">dayToSql</span></a><span>
</span><a name="line-156"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeFromSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#dayFromSql"><span class="hs-identifier hs-var">dayFromSql</span></a><span>
</span><a name="line-157"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">{-|
  'timestamp' defines a type representing a particular point in time (without time zone).
  It corresponds to the &quot;TIMESTAMP with time zone&quot; type in SQL.

  Note: This is NOT a typo. The &quot;TIMESTAMP with time zone&quot; type in SQL does not include
  any actual time zone information. For an excellent explanation of the complexities
  involving this type, please see Chris Clark's blog post about it:
  http://blog.untrod.com/2016/08/actually-understanding-timezones-in-postgresql.html
  -}</span><span>
</span><a name="line-168"></a><span class="hs-identifier">timestamp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><span class="hs-identifier hs-type">Time.UTCTime</span><span>
</span><a name="line-169"></a><a name="timestamp"><a href="Database.Orville.Oracle.Internal.SqlType.html#timestamp"><span class="hs-identifier">timestamp</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-170"></a><span>  </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-var">SqlType</span></a><span>
</span><a name="line-171"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sqlTypeDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;TIMESTAMP with time zone&quot;</span><span>
</span><a name="line-172"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeReferenceDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-173"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeNullable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeId</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlTimestampT</span><span>
</span><a name="line-175"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeSqlSize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeToSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#utcTimeToSql"><span class="hs-identifier hs-var">utcTimeToSql</span></a><span>
</span><a name="line-177"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeFromSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#utcTimeFromSql"><span class="hs-identifier hs-var">utcTimeFromSql</span></a><span>
</span><a name="line-178"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-comment">{-|
  'localTimestamp' defines a type representing a particular point in time in the database time zone.
  It corresponds to the &quot;TIMESTAMP with time zone&quot; type in SQL.

  Note1: The below holds true for `timestamp` and `localTimestamp`, because dealing with time is full of complexities.
  Note2: This is NOT a typo. The &quot;TIMESTAMP with time zone&quot; type in SQL does not include
  any actual time zone information. For an excellent explanation of the complexities
  involving this type, please see Chris Clark's blog post about it:
  http://blog.untrod.com/2016/08/actually-understanding-timezones-in-postgresql.html
  -}</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-identifier">localTimestamp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><span class="hs-identifier hs-type">Time.LocalTime</span><span>
</span><a name="line-192"></a><a name="localTimestamp"><a href="Database.Orville.Oracle.Internal.SqlType.html#localTimestamp"><span class="hs-identifier">localTimestamp</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-193"></a><span>  </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-var">SqlType</span></a><span>
</span><a name="line-194"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sqlTypeDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;TIMESTAMP with time zone&quot;</span><span>
</span><a name="line-195"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeReferenceDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-196"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeNullable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-197"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeId</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlTimestampT</span><span>
</span><a name="line-198"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeSqlSize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-199"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeToSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#localTimeToSql"><span class="hs-identifier hs-var">localTimeToSql</span></a><span>
</span><a name="line-200"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeFromSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#localTimeFromSql"><span class="hs-identifier hs-var">localTimeFromSql</span></a><span>
</span><a name="line-201"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-comment">{-|
  'integerNumber' defines a type for interacting with &quot;NUMBER&quot; in Oracle that
   really are integers -- ie &quot;scale&quot; of 0 with &quot;precision&quot; as input.
-}</span><span>
</span><a name="line-207"></a><span class="hs-identifier">integerNumber</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-208"></a><a name="integerNumber"><a href="Database.Orville.Oracle.Internal.SqlType.html#integerNumber"><span class="hs-identifier">integerNumber</span></a></a><span> </span><a name="local-6989586621679089999"><a href="#local-6989586621679089999"><span class="hs-identifier">precision</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-209"></a><span>  </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-var">SqlType</span></a><span>
</span><a name="line-210"></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sqlTypeDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;NUMBER(&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679089999"><span class="hs-identifier hs-var">precision</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-211"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeReferenceDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-212"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeNullable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-213"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeId</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlDoubleT</span><span> </span><span class="hs-comment">-- Note that &quot;NUMBER&quot; is always decoded as Double by odbc</span><span>
</span><a name="line-214"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeSqlSize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-number">22</span><span class="hs-operator hs-var">*</span><span class="hs-number">8</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- &quot;NUMBER&quot;s in Oracle can be up to 22 bytes!</span><span>
</span><a name="line-215"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeToSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#integerNumberToSql"><span class="hs-identifier hs-var">integerNumberToSql</span></a><span>
</span><a name="line-216"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeFromSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#integerNumberFromSql"><span class="hs-identifier hs-var">integerNumberFromSql</span></a><span>
</span><a name="line-217"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-comment">{-|
  'doubleNumber' defines a type for interacting with &quot;NUMBER&quot; in Oracle that
   really are doubles.
-}</span><span>
</span><a name="line-223"></a><span class="hs-identifier">doubleNumber</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-224"></a><a name="doubleNumber"><a href="Database.Orville.Oracle.Internal.SqlType.html#doubleNumber"><span class="hs-identifier">doubleNumber</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-225"></a><span>  </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-var">SqlType</span></a><span>
</span><a name="line-226"></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sqlTypeDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;NUMBER&quot;</span><span>
</span><a name="line-227"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeReferenceDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-228"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeNullable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-229"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeId</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlDoubleT</span><span>
</span><a name="line-230"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeSqlSize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-number">22</span><span class="hs-operator hs-var">*</span><span class="hs-number">8</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Numbers in Oracle can be up to 22 bytes!</span><span>
</span><a name="line-231"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeToSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#doubleToSql"><span class="hs-identifier hs-var">doubleToSql</span></a><span>
</span><a name="line-232"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeFromSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#doubleFromSql"><span class="hs-identifier hs-var">doubleFromSql</span></a><span>
</span><a name="line-233"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-comment">{-|
   'nullableType' creates a nullable version of an existing 'SqlType'. The underlying
   sql type will be the same as the original, but column will be created with a 'NULL'
   constraint instead a 'NOT NULL' constraint. The Haskell value 'Nothing' will be used
   represent NULL values when converting to and from sql.
  -}</span><span>
</span><a name="line-241"></a><span class="hs-identifier">nullableType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><a href="#local-6989586621679089997"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679089997"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-242"></a><a name="nullableType"><a href="Database.Orville.Oracle.Internal.SqlType.html#nullableType"><span class="hs-identifier">nullableType</span></a></a><span> </span><a name="local-6989586621679090000"><a href="#local-6989586621679090000"><span class="hs-identifier">sqlType</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-243"></a><span>  </span><a href="#local-6989586621679090000"><span class="hs-identifier hs-var">sqlType</span></a><span>
</span><a name="line-244"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sqlTypeNullable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-245"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeToSql</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlNull</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">sqlTypeToSql</span><span> </span><a href="#local-6989586621679090000"><span class="hs-identifier hs-var">sqlType</span></a><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeFromSql</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-247"></a><span>        </span><span class="hs-glyph">\</span><a name="local-6989586621679090001"><a href="#local-6989586621679090001"><span class="hs-identifier">sql</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-248"></a><span>          </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679090001"><span class="hs-identifier hs-var">sql</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-249"></a><span>            </span><span class="hs-identifier hs-var">HDBC.SqlNull</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-250"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier">sqlTypeFromSql</span><span> </span><a href="#local-6989586621679090000"><span class="hs-identifier hs-var">sqlType</span></a><span> </span><a href="#local-6989586621679090001"><span class="hs-identifier hs-var">sql</span></a><span>
</span><a name="line-251"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-252"></a><span>
</span><a name="line-253"></a><span class="hs-comment">{-|
  'foreignRefType' creates a 'SqlType' suitable for columns will be foreign
  keys referencing a column of the given 'SqlType'. For most types the
  underlying sql type with be identical, but for special types (such as
  autoincrementing primary keys), the type construted by 'foreignRefType' with
  have regular underlying sql type. Each 'SqlType' definition must specify any
  special handling required when creating foreign reference types by setting
  the 'sqlTypeReferenceDDL' field to an appropriate value.
  -}</span><span>
</span><a name="line-262"></a><span class="hs-identifier">foreignRefType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><a href="#local-6989586621679089996"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><a href="#local-6989586621679089996"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-263"></a><a name="foreignRefType"><a href="Database.Orville.Oracle.Internal.SqlType.html#foreignRefType"><span class="hs-identifier">foreignRefType</span></a></a><span> </span><a name="local-6989586621679090002"><a href="#local-6989586621679090002"><span class="hs-identifier">sqlType</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-264"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">sqlTypeReferenceDDL</span><span> </span><a href="#local-6989586621679090002"><span class="hs-identifier hs-var">sqlType</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-265"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679090002"><span class="hs-identifier hs-var">sqlType</span></a><span>
</span><a name="line-266"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679090003"><a href="#local-6989586621679090003"><span class="hs-identifier">refDDL</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679090002"><span class="hs-identifier hs-var">sqlType</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">sqlTypeDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679090003"><span class="hs-identifier hs-var">refDDL</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeReferenceDDL</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">}</span><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-comment">{-|
  'maybeConvertSqlType' changes the Haskell type used by a 'SqlType' which changing
  the column type that will be used in the database schema. The functions given
  will be used to convert the now Haskell type to and from the original type when
  reading and writing values from the database. When reading an 'a' value from
  the database, the conversion function should produce 'Nothing' if the value
  cannot be successfully converted to a 'b'
  -}</span><span>
</span><a name="line-276"></a><span class="hs-identifier">maybeConvertSqlType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679089994"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679089995"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679089995"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679089994"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><a href="#local-6989586621679089995"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><a href="#local-6989586621679089994"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-277"></a><a name="maybeConvertSqlType"><a href="Database.Orville.Oracle.Internal.SqlType.html#maybeConvertSqlType"><span class="hs-identifier">maybeConvertSqlType</span></a></a><span> </span><a name="local-6989586621679090004"><a href="#local-6989586621679090004"><span class="hs-identifier">bToA</span></a></a><span> </span><a name="local-6989586621679090005"><a href="#local-6989586621679090005"><span class="hs-identifier">aToB</span></a></a><span> </span><a name="local-6989586621679090006"><a href="#local-6989586621679090006"><span class="hs-identifier">sqlType</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-278"></a><span>  </span><a href="#local-6989586621679090006"><span class="hs-identifier hs-var">sqlType</span></a><span>
</span><a name="line-279"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sqlTypeToSql</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sqlTypeToSql</span><span> </span><a href="#local-6989586621679090006"><span class="hs-identifier hs-var">sqlType</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679090004"><span class="hs-identifier hs-var">bToA</span></a><span>
</span><a name="line-280"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqlTypeFromSql</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679090005"><span class="hs-identifier hs-var">aToB</span></a><span> </span><span class="hs-operator hs-var">&lt;=&lt;</span><span> </span><span class="hs-identifier">sqlTypeFromSql</span><span> </span><a href="#local-6989586621679090006"><span class="hs-identifier hs-var">sqlType</span></a><span>
</span><a name="line-281"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-comment">{-|
  'convertSqlType' changes the Haskell type used by a 'SqlType' in the same manner
  as 'maybeConvertSqlType' in cases where an 'a' can always be converted to a 'b'.
  -}</span><span>
</span><a name="line-287"></a><span class="hs-identifier">convertSqlType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679089992"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679089993"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679089993"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679089992"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><a href="#local-6989586621679089993"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span> </span><a href="#local-6989586621679089992"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-288"></a><a name="convertSqlType"><a href="Database.Orville.Oracle.Internal.SqlType.html#convertSqlType"><span class="hs-identifier">convertSqlType</span></a></a><span> </span><a name="local-6989586621679090007"><a href="#local-6989586621679090007"><span class="hs-identifier">bToA</span></a></a><span> </span><a name="local-6989586621679090008"><a href="#local-6989586621679090008"><span class="hs-identifier">aToB</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#maybeConvertSqlType"><span class="hs-identifier hs-var">maybeConvertSqlType</span></a><span> </span><a href="#local-6989586621679090007"><span class="hs-identifier hs-var">bToA</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679090008"><span class="hs-identifier hs-var">aToB</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span class="hs-identifier">int32ToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int.Int32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span>
</span><a name="line-291"></a><a name="int32ToSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#int32ToSql"><span class="hs-identifier">int32ToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlInt32</span><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span class="hs-identifier">int32FromSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int.Int32</span><span>
</span><a name="line-294"></a><a name="int32FromSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#int32FromSql"><span class="hs-identifier">int32FromSql</span></a></a><span> </span><a name="local-6989586621679090009"><a href="#local-6989586621679090009"><span class="hs-identifier">sql</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-295"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679090009"><span class="hs-identifier hs-var">sql</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-296"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlInt32</span><span> </span><a name="local-6989586621679090010"><a href="#local-6989586621679090010"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679090010"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-297"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlInteger</span><span> </span><a name="local-6989586621679090011"><a href="#local-6989586621679090011"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#toBoundedInteger"><span class="hs-identifier hs-var">toBoundedInteger</span></a><span> </span><a href="#local-6989586621679090011"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-298"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlByteString</span><span> </span><a name="local-6989586621679090012"><a href="#local-6989586621679090012"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">join</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#toBoundedInteger"><span class="hs-identifier hs-var">toBoundedInteger</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readMaybe</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">B8.unpack</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679090012"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-299"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-300"></a><span>
</span><a name="line-301"></a><span class="hs-identifier">int64ToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int.Int64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span>
</span><a name="line-302"></a><a name="int64ToSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#int64ToSql"><span class="hs-identifier">int64ToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlInt64</span><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><span class="hs-identifier">int64FromSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int.Int64</span><span>
</span><a name="line-305"></a><a name="int64FromSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#int64FromSql"><span class="hs-identifier">int64FromSql</span></a></a><span> </span><a name="local-6989586621679090013"><a href="#local-6989586621679090013"><span class="hs-identifier">sql</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-306"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679090013"><span class="hs-identifier hs-var">sql</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-307"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlInt64</span><span> </span><a name="local-6989586621679090014"><a href="#local-6989586621679090014"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679090014"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-308"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlInteger</span><span> </span><a name="local-6989586621679090015"><a href="#local-6989586621679090015"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#toBoundedInteger"><span class="hs-identifier hs-var">toBoundedInteger</span></a><span> </span><a href="#local-6989586621679090015"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-309"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlByteString</span><span> </span><a name="local-6989586621679090016"><a href="#local-6989586621679090016"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">join</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#toBoundedInteger"><span class="hs-identifier hs-var">toBoundedInteger</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readMaybe</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">B8.unpack</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679090016"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-310"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-311"></a><span>
</span><a name="line-312"></a><span class="hs-identifier">textToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span>
</span><a name="line-313"></a><a name="textToSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#textToSql"><span class="hs-identifier">textToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlString</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">T.unpack</span><span>
</span><a name="line-314"></a><span>
</span><a name="line-315"></a><span class="hs-identifier">textFromSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span>
</span><a name="line-316"></a><a name="textFromSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#textFromSql"><span class="hs-identifier">textFromSql</span></a></a><span> </span><a name="local-6989586621679090017"><a href="#local-6989586621679090017"><span class="hs-identifier">sql</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-317"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679090017"><span class="hs-identifier hs-var">sql</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-318"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlByteString</span><span> </span><a name="local-6989586621679090018"><a href="#local-6989586621679090018"><span class="hs-identifier">bytes</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Enc.decodeUtf8</span><span> </span><a href="#local-6989586621679090018"><span class="hs-identifier hs-var">bytes</span></a><span>
</span><a name="line-319"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlString</span><span> </span><a name="local-6989586621679090019"><a href="#local-6989586621679090019"><span class="hs-identifier">string</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><a href="#local-6989586621679090019"><span class="hs-identifier hs-var">string</span></a><span>
</span><a name="line-320"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-identifier">doubleToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span>
</span><a name="line-323"></a><a name="doubleToSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#doubleToSql"><span class="hs-identifier">doubleToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlDouble</span><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-identifier">doubleFromSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-326"></a><a name="doubleFromSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#doubleFromSql"><span class="hs-identifier">doubleFromSql</span></a></a><span> </span><a name="local-6989586621679090020"><a href="#local-6989586621679090020"><span class="hs-identifier">sql</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-327"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679090020"><span class="hs-identifier hs-var">sql</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-328"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlDouble</span><span> </span><a name="local-6989586621679090021"><a href="#local-6989586621679090021"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679090021"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-329"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlByteString</span><span> </span><a name="local-6989586621679090022"><a href="#local-6989586621679090022"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-330"></a><span>      </span><span class="hs-comment">-- Numbers are permitted to begin with a . in Oracle</span><span>
</span><a name="line-331"></a><span>      </span><span class="hs-comment">-- So we have this hacky workaround :(</span><span>
</span><a name="line-332"></a><span>      </span><span class="hs-identifier hs-var">readMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;0&quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">B8.unpack</span><span> </span><a href="#local-6989586621679090022"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-identifier">booleanToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span>
</span><a name="line-336"></a><a name="booleanToSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#booleanToSql"><span class="hs-identifier">booleanToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlBool</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-identifier">booleanFromSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-339"></a><a name="booleanFromSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#booleanFromSql"><span class="hs-identifier">booleanFromSql</span></a></a><span> </span><a name="local-6989586621679090023"><a href="#local-6989586621679090023"><span class="hs-identifier">sql</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-340"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679090023"><span class="hs-identifier hs-var">sql</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-341"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlBool</span><span> </span><a name="local-6989586621679090024"><a href="#local-6989586621679090024"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679090024"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-342"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-343"></a><span>
</span><a name="line-344"></a><span class="hs-identifier">dayToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Time.Day</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span>
</span><a name="line-345"></a><a name="dayToSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#dayToSql"><span class="hs-identifier">dayToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlLocalDate</span><span>
</span><a name="line-346"></a><span>
</span><a name="line-347"></a><span class="hs-identifier">dayFromSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Time.Day</span><span>
</span><a name="line-348"></a><a name="dayFromSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#dayFromSql"><span class="hs-identifier">dayFromSql</span></a></a><span> </span><a name="local-6989586621679090025"><a href="#local-6989586621679090025"><span class="hs-identifier">sql</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-349"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679090025"><span class="hs-identifier hs-var">sql</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-350"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlLocalDate</span><span> </span><a name="local-6989586621679090026"><a href="#local-6989586621679090026"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679090026"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-351"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-352"></a><span>
</span><a name="line-353"></a><span class="hs-identifier">utcTimeToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Time.UTCTime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span>
</span><a name="line-354"></a><a name="utcTimeToSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#utcTimeToSql"><span class="hs-identifier">utcTimeToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlUTCTime</span><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span class="hs-identifier">utcTimeFromSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Time.UTCTime</span><span>
</span><a name="line-357"></a><a name="utcTimeFromSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#utcTimeFromSql"><span class="hs-identifier">utcTimeFromSql</span></a></a><span> </span><a name="local-6989586621679090027"><a href="#local-6989586621679090027"><span class="hs-identifier">sql</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-358"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679090027"><span class="hs-identifier hs-var">sql</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-359"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlUTCTime</span><span>   </span><a name="local-6989586621679090028"><a href="#local-6989586621679090028"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679090028"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-360"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlZonedTime</span><span> </span><a name="local-6989586621679090029"><a href="#local-6989586621679090029"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Time.zonedTimeToUTC</span><span> </span><a href="#local-6989586621679090029"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-361"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-identifier">localTimeToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Time.LocalTime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span>
</span><a name="line-364"></a><a name="localTimeToSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#localTimeToSql"><span class="hs-identifier">localTimeToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlLocalTime</span><span>
</span><a name="line-365"></a><span>
</span><a name="line-366"></a><span class="hs-identifier">localTimeFromSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Time.LocalTime</span><span>
</span><a name="line-367"></a><a name="localTimeFromSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#localTimeFromSql"><span class="hs-identifier">localTimeFromSql</span></a></a><span> </span><a name="local-6989586621679090030"><a href="#local-6989586621679090030"><span class="hs-identifier">sql</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-368"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679090030"><span class="hs-identifier hs-var">sql</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-369"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlLocalTime</span><span> </span><a name="local-6989586621679090031"><a href="#local-6989586621679090031"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679090031"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-370"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-371"></a><span>
</span><a name="line-372"></a><span class="hs-identifier">integerNumberToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span>
</span><a name="line-373"></a><a name="integerNumberToSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#integerNumberToSql"><span class="hs-identifier">integerNumberToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HDBC.SqlDouble</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><span class="hs-identifier">integerNumberFromSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HDBC.SqlValue</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-376"></a><a name="integerNumberFromSql"><a href="Database.Orville.Oracle.Internal.SqlType.html#integerNumberFromSql"><span class="hs-identifier">integerNumberFromSql</span></a></a><span> </span><a name="local-6989586621679090032"><a href="#local-6989586621679090032"><span class="hs-identifier">sql</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-377"></a><span>   </span><span class="hs-comment">-- Depending on how the column was created the &quot;NUMBER&quot; type can come back as a SqlDouble or a SqlByteString...</span><span>
</span><a name="line-378"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679090032"><span class="hs-identifier hs-var">sql</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-379"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlDouble</span><span> </span><a name="local-6989586621679090033"><a href="#local-6989586621679090033"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#doubleToInteger"><span class="hs-identifier hs-var">doubleToInteger</span></a><span> </span><a href="#local-6989586621679090033"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-380"></a><span>    </span><span class="hs-identifier hs-var">HDBC.SqlByteString</span><span> </span><a name="local-6989586621679090034"><a href="#local-6989586621679090034"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">join</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Database.Orville.Oracle.Internal.SqlType.html#doubleToInteger"><span class="hs-identifier hs-var">doubleToInteger</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readMaybe</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">B8.unpack</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679090034"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-381"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span class="hs-identifier">doubleToInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-384"></a><a name="doubleToInteger"><a href="Database.Orville.Oracle.Internal.SqlType.html#doubleToInteger"><span class="hs-identifier">doubleToInteger</span></a></a><span> </span><a name="local-6989586621679090035"><a href="#local-6989586621679090035"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-385"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679090036"><a href="#local-6989586621679090036"><span class="hs-identifier">n</span></a></a><span class="hs-special">,</span><a name="local-6989586621679090037"><a href="#local-6989586621679090037"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">properFraction</span><span> </span><a href="#local-6989586621679090035"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-386"></a><span>  </span><span class="hs-keyword">in</span><span>
</span><a name="line-387"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679090037"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-388"></a><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679090036"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-389"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-390"></a><span>
</span><a name="line-391"></a><span class="hs-identifier">toBoundedInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bounded</span><span> </span><a href="#local-6989586621679089903"><span class="hs-identifier hs-type">num</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679089903"><span class="hs-identifier hs-type">num</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679089903"><span class="hs-identifier hs-type">num</span></a><span>
</span><a name="line-392"></a><a name="toBoundedInteger"><a href="Database.Orville.Oracle.Internal.SqlType.html#toBoundedInteger"><span class="hs-identifier">toBoundedInteger</span></a></a><span> </span><a name="local-6989586621679090038"><a href="#local-6989586621679090038"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-393"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679090039"><a href="#local-6989586621679090039"><span class="hs-identifier">truncated</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621679090038"><span class="hs-identifier hs-var">source</span></a><span>
</span><a name="line-394"></a><span>      </span><a name="local-6989586621679090040"><a href="#local-6989586621679090040"><span class="hs-identifier">upper</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maxBound</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">asTypeOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679090039"><span class="hs-identifier hs-var">truncated</span></a><span class="hs-special">)</span><span>
</span><a name="line-395"></a><span>      </span><a name="local-6989586621679090041"><a href="#local-6989586621679090041"><span class="hs-identifier">lower</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minBound</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">asTypeOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679090039"><span class="hs-identifier hs-var">truncated</span></a><span class="hs-special">)</span><span>
</span><a name="line-396"></a><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679090041"><span class="hs-identifier hs-var">lower</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679090038"><span class="hs-identifier hs-var">source</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679090038"><span class="hs-identifier hs-var">source</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679090040"><span class="hs-identifier hs-var">upper</span></a><span>
</span><a name="line-397"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679090039"><span class="hs-identifier hs-var">truncated</span></a><span>
</span><a name="line-398"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-399"></a></pre></body></html>